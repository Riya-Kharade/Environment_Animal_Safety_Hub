//====================================// Sample Events Data //====================================
const sampleEvents=[{id:1,title:"Marina Beach Cleanup Drive",category:"cleanup",date:"2026-01-25",time:"07:00",location:"Marina Beach,Chennai",coordinates:[13.0500,80.2824],description:"Join us for a morning beach cleanup! We'll provide gloves,bags,and refreshments. Together,let's make Marina Beach cleaner and safer for marine life.",organizer:"EcoLife Chennai",maxParticipants:50,attendees:32,image:"https://images.unsplash.com/photo-1618477461853-cf6ed80faba5?w=600"},{id:2,title:"Urban Forest Plantation",category:"plantation",date:"2026-01-28",time:"08:00",location:"Guindy National Park,Chennai",coordinates:[13.0067,80.2206],description:"Help us plant 500 native trees to create an urban forest. All saplings and tools will be provided. Wear comfortable clothes and bring your enthusiasm!",organizer:"Green Earth Foundation",maxParticipants:100,attendees:67,image:"https://images.unsplash.com/photo-1542601906990-b4d3fb778b09?w=600"},{id:3,title:"Wildlife Photography Workshop",category:"workshop",date:"2026-02-01",time:"09:00",location:"Theosophical Society,Adyar",coordinates:[13.0205,80.2579],description:"Learn wildlife photography from professionals. Understand animal behavior,camera settings,and ethical photography practices. Cameras provided for beginners.",organizer:"Nature Photographers Club",maxParticipants:25,attendees:18,image:"https://images.unsplash.com/photo-1549366021-9f761d450615?w=600"},{id:4,title:"Stray Animal Feeding Program",category:"animal-care",date:"2026-01-26",time:"06:30",location:"Anna Nagar,Chennai",coordinates:[13.0850,80.2101],description:"Daily feeding program for stray dogs and cats. We need volunteers to help distribute food and water. Training provided for first-time volunteers.",organizer:"Paws & Care NGO",maxParticipants:20,attendees:12,image:"https://images.unsplash.com/photo-1601758228041-f3b2795255f1?w=600"},{id:5,title:"Lake Restoration Project",category:"cleanup",date:"2026-02-05",time:"07:30",location:"Perungudi Lake,Chennai",coordinates:[12.9539,80.2371],description:"Help restore the Perungudi Lake by removing invasive plants,picking up trash,and planting native aquatic species. Boats and equipment provided.",organizer:"Lake Conservation Society",maxParticipants:40,attendees:28,image:"https://images.unsplash.com/photo-1519451241324-20b4ea2c4220?w=600"},{id:6,title:"Composting Workshop",category:"workshop",date:"2026-02-08",time:"10:00",location:"Community Center,T. Nagar",coordinates:[13.0418,80.2341],description:"Learn how to turn kitchen waste into nutrient-rich compost. Hands-on session with take-home starter kit included. Perfect for beginners!",organizer:"Zero Waste Chennai",maxParticipants:30,attendees:24,image:"https://images.unsplash.com/photo-1416879595882-3373a0480b5b?w=600"}];

//====================================// Global State //====================================
let events=[];
let userRSVPs=new Set();
let map=null;
let markers=[];

//====================================// Initialize //====================================
document.addEventListener('DOMContentLoaded',()=>{
loadEvents();
initializeMap();
renderEvents();
setupEventListeners();
loadUserRSVPs();
updateStats();
});

//====================================// Interactive Map (Leaflet.js) //====================================
function initializeMap(){
const mapElement=document.getElementById('events-map');
if(!mapElement)return;

// Initialize map centered on Chennai
map=L.map('events-map').setView([13.0827,80.2707],12);

// ✅ UPDATED EXTERNAL LINK (Issue #2271 Fix)
L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png',{
attribution:'&copy;<a href="https://www.openstreetmap.org/copyright" target="_blank" rel="noopener noreferrer external">OpenStreetMap</a> contributors'
}).addTo(map);

addEventMarkers();
}
